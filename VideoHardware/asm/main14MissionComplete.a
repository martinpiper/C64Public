!source "main14Options.a"

!to "bin/mainMissionComplete.prg", cbm
!sal
!sl "tmp/mainMissionComplete.map"
!svl "tmp/mainMissionComplete.lbl"
!pdb "tmp/mainMissionComplete.pdb"
!cpu 6510
!ct pet

!source "stdlib/stdlib.a"
!source "stdlib/Comparisons.a"
!source "stdlib/PETSCII.a"
!source "stdlib/LongBranches.a"

!source "BombJack/stdlib/Bus24Bit_Macros.a"
!source "BombJack/stdlib/Bus20To32Bit1_Macros.a"
!source "BombJack/stdlib/Video_Macros.a"
!source "BombJack/stdlib/APU_Macros.a"

!source "AfterBurner/LandscapeDefs.a"
!source "AfterBurner/SpriteMacros.a"
!source "AfterBurner/SampleMacros.a"



!zn
*=$200
start
	+MStopInitStack_X
	jmp mainLoop

!source "tmp/FingerPrint.a"
!source "BombJack/stdlib/APU.a"

;Initialise_NoPreserveStack = 1
;Initialise_NoIRQServiceRoutine = 1
;Initialise_NoMACROWaitForTheLastScan = 1
;!source "stdlib/Initialise.a"

* = SCREENRAM
!source "AfterBurner/CommonBootDefinesPre.a"
!source "tmp\CommonBootDefines.a"
!source "tmp\CommonAPUDefines.a"
!source "BombJack/stdlib/Audio.a"
!source "BombJack/stdlib/Video.a"
ExternalMemory_NoChecksums = 1
ExternalMemory_NoDebug = 1
!source "asm/ExternalMemory.a"
DisplayHexFromAAtX	; Stops the debug display for ExternalMemory DMA
	rts

!source "BombJack/stdlib/Bus20To32Bit1_CopyFrom.a"
!source "AfterBurner/PaletteFade.a"
!source "Citadel2\asm\Score.a"
ScoreHandler_Init_Only = 1
!source "AfterBurner/ScoreHandlers.a"

!source "tmp/Demo14AddFile_ResourcesMissionComplete.a"
!source "tmp/Demo14AddFile_ResourcesMissionCompleteRestore.a"

!zn
mainLoop
	+MByteValueToAddress_A ProcessorPortAllRAMWithIO , ZPProcessorPort
;	lda #ProcessorPortAllRAMWithIO
;	jsr InitialiseMachine

	jsr Bus24Bit_Init
	jsr Bus20To32Bit1_Init

	lda RunGameMissionComplete
	+lbeq DisplayRunIntroScreens

	jmp RunEndCredits

	!source "AfterBurner/EndCredits.a"
	!source "AfterBurner/IntroScreens.a"

+MCheckNotInIOKernal


+MCheckNotInKERNALServiceVectors
